import streamlit as st
import yfinance as yf
import pandas as pd
import time
from datetime import datetime
import base64
import io
import matplotlib.pyplot as plt
import pandas as pd
import streamlit as st


# List of 6300 predefined stocks
stocks = ["0522.HK","0104.HK","0933.HK","0180.HK","6388.HK","0718.HK","0494.HK","0316.HK","0233.HK","0055.HK","0524.HK","0703.HK","0005.HK","2888.HK","1222.HK","0992.HK","0293.HK","0388.HK","0017.HK","0941.HK","0688.HK","0291.HK","0027.HK","0242.HK","0011.HK","0006.HK","0004.HK","0003.HK","3377.HK","2388.HK","1299.HK","0883.HK","0817.HK","0762.HK","0392.HK","0257.HK","0252.HK","1668.HK","0900.HK","0808.HK","0716.HK","0705.HK","0669.HK","0656.HK","0619.HK","0363.HK","0303.HK","0267.HK","0245.HK","0184.HK","0144.HK","0105.HK","0083.HK","0071.HK","0045.HK","0020.HK","0016.HK","0008.HK","8022.HK","2380.HK","1972.HK","1360.HK","1208.HK","1029.HK","0984.HK","0966.HK","0887.HK","0882.HK","0836.HK","0708.HK","0639.HK","0450.HK","0375.HK","0308.HK","0295.HK","0294.HK","0285.HK","0273.HK","0271.HK","0254.HK","0247.HK","0244.HK","0202.HK","0137.HK","0131.HK","0123.HK","0101.HK","0086.HK","0081.HK","0028.HK","0023.HK","0021.HK","0019.HK","0012.HK","0647.HK","0486.HK","1245.HK","0805.HK","8391.HK","1928.HK","0700.HK","2282.HK","0001.HK","3800.HK","1833.HK","1044.HK","3383.HK","3333.HK","2319.HK","0337.HK","3322.HK","3308.HK","2877.HK","2383.HK","1700.HK","1212.HK","1112.HK","0868.HK","0862.HK","0829.HK","0575.HK","0210.HK","3998.HK","3900.HK","3818.HK","2369.HK","2348.HK","2300.HK","2038.HK","2007.HK","1986.HK","1889.HK","1880.HK","1638.HK","1515.HK","1313.HK","1234.HK","1221.HK","1149.HK","1128.HK","1125.HK","1083.HK","1059.HK","0981.HK","0919.HK","0825.HK","0809.HK","0757.HK","0745.HK","0713.HK","0631.HK","0607.HK","0425.HK","0379.HK","0318.HK","0183.HK","8356.HK","8296.HK","8295.HK","8269.HK","8250.HK","8207.HK","8198.HK","8185.HK","8181.HK","8178.HK","8173.HK","8163.HK","8137.HK","8119.HK","8071.HK","8041.HK","8019.HK","8006.HK","8003.HK","6868.HK","3999.HK","3933.HK","3918.HK","3889.HK","3888.HK","3883.HK","3777.HK","3669.HK","3337.HK","3331.HK","3318.HK","3311.HK","2955.HK","2382.HK","2342.HK","2324.HK","2313.HK","2309.HK","2302.HK","2283.HK","2280.HK","2111.HK","1998.HK","1938.HK","1929.HK","1831.HK","1823.HK","1717.HK","1683.HK","1661.HK","1623.HK","1616.HK","1600.HK","1555.HK","1498.HK","1396.HK","1393.HK","1372.HK","1363.HK","1361.HK","1348.HK","1335.HK","1333.HK","1323.HK","1318.HK","1293.HK","1230.HK","1219.HK","1198.HK","1181.HK","1175.HK","1165.HK","1161.HK","1142.HK","1106.HK","1073.HK","1070.HK","1009.HK","1007.HK","0963.HK","0923.HK","0917.HK","0913.HK","0896.HK","0884.HK","0877.HK","0867.HK","0827.HK","0773.HK","0768.HK","0737.HK","0682.HK","0646.HK","0572.HK","0546.HK","0505.HK","0475.HK","0474.HK","0468.HK","0459.HK","0449.HK","0410.HK","0400.HK","0395.HK","0356.HK","0354.HK","0353.HK","0311.HK","0272.HK","0269.HK","0268.HK","0223.HK","0208.HK","0195.HK","0121.HK","0120.HK","0072.HK","0047.HK","0039.HK","0035.HK","0033.HK","8387.HK","8272.HK","8266.HK","8256.HK","8242.HK","8226.HK","8225.HK","8213.HK","8212.HK","8203.HK","8196.HK","8193.HK","8169.HK","8167.HK","8165.HK","8156.HK","8148.HK","8143.HK","8133.HK","8128.HK","8117.HK","8116.HK","8112.HK","8103.HK","8097.HK","8092.HK","8090.HK","8085.HK","8077.HK","8068.HK","8066.HK","8061.HK","8060.HK","8053.HK","8051.HK","8032.HK","8031.HK","8030.HK","8029.HK","8008.HK","8001.HK","6899.HK","6896.HK","6888.HK","6833.HK","6166.HK","8219.HK","3989.HK","3963.HK","3899.HK","3882.HK","3868.HK","3838.HK","3828.HK","3688.HK","3666.HK","3628.HK","3382.HK","3368.HK","3336.HK","3335.HK","3313.HK","2991.HK","2986.HK","2910.HK","2903.HK","2898.HK","2889.HK","2728.HK","2662.HK","2623.HK","2618.HK","2608.HK","2398.HK","2393.HK","2371.HK","2368.HK","2358.HK","2341.HK","2336.HK","2331.HK","2330.HK","2317.HK","2288.HK","2255.HK","2211.HK","2198.HK","2168.HK","2138.HK","2128.HK","2118.HK","2078.HK","2018.HK","2014.HK","1980.HK","1918.HK","1900.HK","1888.HK","1886.HK","1882.HK","1836.HK","1830.HK","1813.HK","1808.HK","1803.HK","1778.HK","1771.HK","1718.HK","1685.HK","1678.HK","1669.HK","1628.HK","1520.HK","1509.HK","1421.HK","1395.HK","1388.HK","1387.HK","1382.HK","1381.HK","1378.HK","1366.HK","1358.HK","1338.HK","1319.HK","1317.HK","1315.HK","1308.HK","1300.HK","1277.HK","1273.HK","1263.HK","1259.HK","1250.HK","1249.HK","1247.HK","1240.HK","1236.HK","1232.HK","1185.HK","1143.HK","1130.HK","1115.HK","1113.HK","1110.HK","1109.HK","1087.HK","1080.HK","1039.HK","1030.HK","1020.HK","1019.HK","1006.HK","0987.HK","0978.HK","0975.HK","0969.HK","0951.HK","0936.HK","0929.HK","0911.HK","0873.HK","0860.HK","0856.HK","0853.HK","0852.HK","0848.HK","0846.HK","0845.HK","0838.HK","0837.HK","0833.HK","0830.HK","0828.HK","0826.HK","0819.HK","0813.HK","0800.HK","0777.HK","0775.HK","0756.HK","0746.HK","0732.HK","0698.HK","0691.HK","0672.HK","0660.HK","0609.HK","0602.HK","0596.HK","0586.HK","0565.HK","0554.HK","0540.HK","0531.HK","0509.HK","0503.HK","0480.HK","0477.HK","0465.HK","0445.HK","0444.HK","0434.HK","0428.HK","0426.HK","0423.HK","0419.HK","0413.HK","0408.HK","0402.HK","0364.HK","0359.HK","0352.HK","0348.HK","0322.HK","0319.HK","0312.HK","0288.HK","0279.HK","0264.HK","0256.HK","0248.HK","0197.HK","0196.HK","0175.HK","0157.HK","0153.HK","0151.HK","0148.HK","0143.HK","0130.HK","0117.HK","0098.HK","0080.HK","0065.HK","2121.HK","8230.HK","8290.HK","8140.HK","0699.HK","8361.HK","2100.HK","0469.HK","8368.HK","1022.HK","8277.HK","2277.HK","2379.HK","1910.HK","2946.HK","0243.HK","6230.HK","6836.HK","6210.HK","1568.HK","1733.HK","1278.HK","0532.HK","3009.HK","3035.HK","3019.HK","3027.HK","2921.HK","0096.HK","4332.HK","170.HK","0595.HK","8390.HK","2941.HK","2936.HK","8380.HK","8389.HK","2935.HK","2928.HK","8376.HK","2937.HK","2930.HK","2927.HK","8385.HK","2926.HK","8107.HK","6288.HK","2366.HK","1205.HK","1201.HK","1184.HK","1127.HK","1098.HK","1001.HK","0878.HK","0861.HK","0758.HK","0724.HK","0723.HK","0702.HK","0641.HK","0618.HK","0617.HK","0506.HK","0385.HK","0297.HK","0212.HK","0209.HK","0166.HK","0142.HK","0135.HK","8400.HK","8306.HK","8228.HK","8089.HK","8079.HK","1224.HK","1218.HK","1174.HK","1168.HK","1139.HK","1123.HK","1063.HK","1047.HK","1045.HK","1041.HK","1038.HK","1031.HK","0999.HK","0979.HK","0970.HK","0912.HK","0908.HK","0897.HK","0889.HK","0859.HK","0751.HK","0710.HK","0709.HK","0687.HK","0659.HK","0657.HK","0636.HK","0610.HK","0577.HK","0551.HK","0535.HK","0529.HK","0510.HK","0493.HK","0491.HK","0485.HK","0479.HK","0467.HK","0396.HK","0372.HK","0343.HK","0341.HK","0336.HK","0334.HK","0330.HK","0307.HK","0296.HK","0286.HK","0255.HK","0240.HK","0234.HK","0232.HK","0213.HK","0211.HK","0207.HK","0179.HK","0163.HK","0139.HK","0129.HK","0113.HK","0100.HK","0093.HK","0092.HK","0075.HK","0052.HK","0046.HK","0029.HK","0009.HK","8375.HK","8351.HK","8279.HK","8270.HK","8265.HK","8192.HK","8176.HK","8175.HK","8159.HK","8153.HK","8150.HK","8131.HK","8108.HK","8086.HK","8081.HK","8080.HK","8048.HK","8047.HK","8037.HK","8033.HK","8005.HK","2340.HK","2327.HK","2326.HK","2323.HK","2322.HK","2088.HK","1556.HK","1447.HK","1431.HK","1371.HK","1223.HK","1200.HK","1193.HK","1191.HK","1189.HK","1188.HK","1180.HK","1170.HK","1169.HK","1166.HK","1141.HK","1118.HK","1114.HK","1094.HK","1091.HK","1079.HK","1052.HK","1051.HK","1050.HK","1046.HK","1043.HK","1037.HK","1013.HK","1010.HK","1005.HK","1004.HK","1003.HK","0993.HK","0989.HK","0986.HK","0983.HK","0982.HK","0959.HK","0952.HK","0934.HK","0925.HK","0922.HK","0907.HK","0905.HK","0903.HK","0899.HK","0898.HK","0891.HK","0888.HK","0875.HK","0869.HK","0858.HK","0855.HK","0834.HK","0818.HK","0812.HK","0803.HK","0789.HK","0771.HK","0765.HK","0764.HK","0761.HK","0755.HK","0738.HK","0730.HK","0726.HK","0721.HK","0720.HK","0717.HK","0715.HK","0711.HK","0693.HK","0686.HK","0683.HK","0681.HK","0678.HK","0677.HK","0676.HK","0675.HK","0665.HK","0662.HK","0661.HK","0635.HK","0628.HK","0622.HK","0621.HK","0613.HK","0603.HK","0601.HK","0590.HK","0583.HK","0582.HK","0581.HK","0526.HK","0517.HK","0500.HK","0498.HK","0487.HK","0482.HK","0451.HK","0430.HK","0418.HK","0417.HK","0404.HK","0403.HK","0399.HK","0397.HK","0393.HK","0391.HK","0389.HK","0387.HK","0384.HK","0367.HK","0366.HK","0365.HK","0342.HK","0340.HK","0333.HK","0332.HK","0328.HK","0327.HK","0315.HK","0306.HK","0292.HK","0275.HK","0262.HK","0251.HK","0239.HK","0230.HK","0224.HK","0221.HK","0214.HK","0205.HK","0190.HK","0188.HK","0182.HK","0176.HK","0173.HK","0164.HK","0159.HK","0147.HK","0146.HK","0136.HK","0127.HK","0125.HK","0110.HK","0106.HK","0102.HK","0084.HK","0079.HK","0073.HK","0069.HK","0063.HK","0062.HK","0061.HK","0059.HK","0057.HK","0053.HK","0043.HK","0041.HK","0025.HK","0024.HK","0022.HK","0007.HK","0701.HK","0643.HK","0109.HK","0864.HK","0476.HK","0679.HK","0305.HK","1163.HK","0339.HK","1120.HK","0620.HK","0645.HK","0155.HK","0835.HK","0377.HK","2940.HK","0684.HK","0787.HK","8109.HK","8172.HK","0149.HK","0927.HK","0854.HK","3300.HK","1207.HK","0638.HK","0754.HK","1152.HK","0261.HK","0132.HK","0198.HK","1215.HK","8082.HK","0563.HK","8078.HK","3839.HK","0530.HK","0547.HK","0058.HK","0725.HK","0550.HK","0460.HK","0651.HK","8016.HK","0685.HK","0894.HK","0810.HK","8021.HK","0655.HK","0938.HK","0519.HK","0996.HK","0997.HK","0512.HK","1229.HK","8386.HK","0642.HK","8076.HK","1132.HK","8393.HK","0495.HK","0759.HK","0015.HK","0433.HK","0114.HK","0167.HK","0497.HK","1682.HK","0310.HK","0940.HK","1999.HK","2902.HK","8083.HK","2886.HK","1192.HK","0851.HK","0030.HK","3813.HK","0673.HK","0508.HK","0750.HK","1131.HK","1663.HK","0289.HK","0472.HK","0904.HK","0126.HK","0990.HK","0116.HK","8202.HK","0398.HK","0760.HK","0169.HK","8317.HK","0736.HK","0231.HK","1199.HK","8100.HK","1082.HK","1049.HK","2908.HK","0585.HK","0592.HK","0910.HK","0571.HK","0412.HK","0767.HK","1028.HK","0088.HK","2904.HK","2975.HK","0611.HK","8166.HK","2343.HK","0406.HK","2983.HK","1225.HK","2917.HK","2882.HK","8046.HK","0204.HK","1332.HK","0689.HK","0499.HK","0544.HK","0566.HK","1105.HK","8120.HK","8186.HK","0626.HK","2186.HK","0199.HK","8075.HK","3363.HK","1104.HK","0943.HK","1262.HK","1064.HK","0948.HK","0589.HK","1187.HK","0909.HK","0627.HK","0729.HK","8271.HK","0616.HK","0632.HK","0241.HK","1213.HK","6108.HK","0578.HK","0567.HK","2668.HK","0593.HK","0078.HK","1076.HK","0704.HK","0186.HK","0152.HK","0138.HK","8239.HK","2916.HK","2997.HK","2944.HK","0918.HK","0630.HK","2900.HK","1182.HK","0085.HK","0321.HK","8130.HK","1124.HK","1159.HK","0674.HK","0731.HK","0706.HK","0431.HK","3886.HK","0346.HK","0298.HK","1196.HK","0432.HK","0082.HK","0276.HK","1220.HK","1160.HK","0915.HK","0162.HK","0380.HK","1768.HK","6828.HK","2123.HK","1298.HK","0371.HK","1060.HK","0378.HK","0355.HK","100.HK","8222.HK","8059.HK","8170.HK","8139.HK","8305.HK","1470.HK","8381.HK","8372.HK","8177.HK","2949.HK","2925.HK","8012.HK","2948.HK","8379.HK","8396.HK","8141.HK","2942.HK","2931.HK","2938.HK","8369.HK","2922.HK","2932.HK","8395.HK","2934.HK","8327.HK","1561.HK","2950.HK","8038.HK","2193.HK","8027.HK","8378.HK","2933.HK","8373.HK","1341.HK","2920.HK","8248.HK","2924.HK","2912.HK","2923.HK","2929.HK","0557.HK","0939.HK","1211.HK","0386.HK","3988.HK","2318.HK","1398.HK","0338.HK","0902.HK","0857.HK","0390.HK","8243.HK","8211.HK","6030.HK","2777.HK","2328.HK","1798.HK","0998.HK","0728.HK","0549.HK","0323.HK","8348.HK","3606.HK","3378.HK","3323.HK","2899.HK","2868.HK","2866.HK","2727.HK","2722.HK","2628.HK","2202.HK","2196.HK","2006.HK","1988.HK","1919.HK","1898.HK","1800.HK","1776.HK","1533.HK","1339.HK","1288.HK","1171.HK","1138.HK","1099.HK","1088.HK","1055.HK","1053.HK","0995.HK","0991.HK","0980.HK","0814.HK","0763.HK","0694.HK","0598.HK","0489.HK","0107.HK","0042.HK","8249.HK","8247.HK","8227.HK","8205.HK","8197.HK","8189.HK","8106.HK","8058.HK","8045.HK","6886.HK","6869.HK","6198.HK","6196.HK","3983.HK","3908.HK","3699.HK","3698.HK","3618.HK","3399.HK","3396.HK","3355.HK","3328.HK","2883.HK","2880.HK","2799.HK","2698.HK","2607.HK","2601.HK","2600.HK","2488.HK","2357.HK","2355.HK","2333.HK","2208.HK","1893.HK","1816.HK","1812.HK","1799.HK","1766.HK","1588.HK","1558.HK","1543.HK","1528.HK","1476.HK","1459.HK","1359.HK","1186.HK","1157.HK","1133.HK","1108.HK","1072.HK","1071.HK","1066.HK","1065.HK","1057.HK","1033.HK","0956.HK","0914.HK","0874.HK","0753.HK","0747.HK","0696.HK","0568.HK","0564.HK","0525.HK","0438.HK","0416.HK","0347.HK","0168.HK","0161.HK","6881.HK","8253.HK","8258.HK","3903.HK","0958.HK","1513.HK","3636.HK","1708.HK","1265.HK","8301.HK","2238.HK","1461.HK","6839.HK","0839.HK","1456.HK","0811.HK","3969.HK","0300.HK","8095.HK","1025.HK","8115.HK","1103.HK","1618.HK","1075.HK","3996.HK","8049.HK","3968.HK","6865.HK","1829.HK","1666.HK","0840.HK","0358.HK","1958.HK","1296.HK","6818.HK","3369.HK","1819.HK","6837.HK","0038.HK","6116.HK","6138.HK","0576.HK","8273.HK","0895.HK","1599.HK","0916.HK","8235.HK","1385.HK","2066.HK","2120.HK","0317.HK","3866.HK","0816.HK","1292.HK","1349.HK","1858.HK","0548.HK","8286.HK","8236.HK","1818.HK","0588.HK","0954.HK","1289.HK","0357.HK","0177.HK","2218.HK","0552.HK","0719.HK","2338.HK","1375.HK","0921.HK","0579.HK","3330.HK","1122.HK","2386.HK","1508.HK","0553.HK","2068.HK","1963.HK","1786.HK","0350.HK","8215.HK","3043.HK","3048.HK","6889.HK","8366.HK","6823.HK","6808.HK","6139.HK","3188.HK","3124.HK","3117.HK","3070.HK","3037.HK","2919.HK","2830.HK","2356.HK","1883.HK","1788.HK","1347.HK","1270.HK","1258.HK","1137.HK","1111.HK","1097.HK","0906.HK","0880.HK","0823.HK","0697.HK","0668.HK","0648.HK","0623.HK","0606.HK","0560.HK","0533.HK","0521.HK","0513.HK","0511.HK","0488.HK","0435.HK","0420.HK","0382.HK","0376.HK","0373.HK","0368.HK","0351.HK","0287.HK","0282.HK","0280.HK","0278.HK","0270.HK","0260.HK","0236.HK","0235.HK","0227.HK","0225.HK","0219.HK","0218.HK","0217.HK","0200.HK","0193.HK","0191.HK","0185.HK","0174.HK","0172.HK","0160.HK","0158.HK","0156.HK","0154.HK","0122.HK","0108.HK","0091.HK","0076.HK","0068.HK","0066.HK","0051.HK","0031.HK","0014.HK","0010.HK","0002.HK","3143.HK","8067.HK","3101.HK","8125.HK","3157.HK","0050.HK","0141.HK","0145.HK","3137.HK","0229.HK","3076.HK","0411.HK","0026.HK","3051.HK","3090.HK","87001.HK","0237.HK","3121.HK","3126.HK","2982.HK","0604.HK","0625.HK","8162.HK","3021.HK","3160.HK","2808.HK","0181.HK","2990.HK","3128.HK","1093.HK","0821.HK","3041.HK","0171.HK","3118.HK","0440.HK","0266.HK","3054.HK","1828.HK","0663.HK","2822.HK","0283.HK","0044.HK","0118.HK","3145.HK","3100.HK","3808.HK","3315.HK","0087.HK","0194.HK","0277.HK","3066.HK","3075.HK","0170.HK","2973.HK","3060.HK","3122.HK","2805.HK","3072.HK","1266.HK","0281.HK","0133.HK","8009.HK","3120.HK","3360.HK","3162.HK","0036.HK","0037.HK","0165.HK","3161.HK","3127.HK","0605.HK","0060.HK","0253.HK","0250.HK","3136.HK","0034.HK","1881.HK","3086.HK","0666.HK","0201.HK","0097.HK","3134.HK","0054.HK","2996.HK","3119.HK","2993.HK","3029.HK","0222.HK","0518.HK","3140.HK","0216.HK","1203.HK","8028.HK","0089.HK","0405.HK","2832.HK","3102.HK","3156.HK","6161.HK","0070.HK","0570.HK","3040.HK","2778.HK","3139.HK","0536.HK","8191.HK","2811.HK","1426.HK","3091.HK","3095.HK","3098.HK","3150.HK","3180.HK","3129.HK","0128.HK","0263.HK","2638.HK","1126.HK","1275.HK","0226.HK","0112.HK","3165.HK","3056.HK","2310.HK","3149.HK","3199.HK","0032.HK","2666.HK","3084.HK","0345.HK","0056.HK","3008.HK","0018.HK","3141.HK","1058.HK","0119.HK","3064.HK","1639.HK","0727.HK","0103.HK","3085.HK","3031.HK","3078.HK","2909.HK","2939.HK","3147.HK","3132.HK","0820.HK","3089.HK","3110.HK","2824.HK","8138.HK","0040.HK","3107.HK","3069.HK","8326.HK","0799.HK","1970.HK","1913.HK","2233.HK","2011.HK","0442.HK","1280.HK","1530.HK","2023.HK","1466.HK","0947.HK","2086.HK","8171.HK","1340.HK","1253.HK","1438.HK","2200.HK","1116.HK","2901.HK","6183.HK","1400.HK","8182.HK","2906.HK","1446.HK","8267.HK","1260.HK","0329.HK","3663.HK","0612.HK","1369.HK","1026.HK","6880.HK","8129.HK","1662.HK","1312.HK","2399.HK","8325.HK","6838.HK","8026.HK","2236.HK","8093.HK","0064.HK","6893.HK","8233.HK","1538.HK","0320.HK","0520.HK","0893.HK","8282.HK","8316.HK","2080.HK","1452.HK","1884.HK","8132.HK","1316.HK","2312.HK","0090.HK","2212.HK","1089.HK","1613.HK","8307.HK","1993.HK","1492.HK","8312.HK","8113.HK","0863.HK","0653.HK","2286.HK","0640.HK","8397.HK","8020.HK","3737.HK","2947.HK","3600.HK","0462.HK","1227.HK","8336.HK","1282.HK","6882.HK","2223.HK","8011.HK","1522.HK","8072.HK","1499.HK","2788.HK","2188.HK","8268.HK","1439.HK","1023.HK","0960.HK","8206.HK","8155.HK","8340.HK","1345.HK","0360.HK","0798.HK","6168.HK","1430.HK","0743.HK","1178.HK","0822.HK","1370.HK","1290.HK","8209.HK","2678.HK","1681.HK","8145.HK","1468.HK","6863.HK","6898.HK","1121.HK","0690.HK","1367.HK","8218.HK","1968.HK","8260.HK","8200.HK","1251.HK","3708.HK","3966.HK","2960.HK","3639.HK","2020.HK","2002.HK","0483.HK","2008.HK","1899.HK","1314.HK","1117.HK","1239.HK","1252.HK","1355.HK","2943.HK","1397.HK","1164.HK","1226.HK","8147.HK","8310.HK","8399.HK","1233.HK","6123.HK","8195.HK","3344.HK","0850.HK","1380.HK","3393.HK","0658.HK","0246.HK","2878.HK","8087.HK","1329.HK","0258.HK","3366.HK","2226.HK","0574.HK","0220.HK","2221.HK","1096.HK","0600.HK","3326.HK","1246.HK","0707.HK","0543.HK","1838.HK","0401.HK","8036.HK","0712.HK","2112.HK","1908.HK","1062.HK","1002.HK","1140.HK","6830.HK","0189.HK","1368.HK","2307.HK","1856.HK","1090.HK","8355.HK","1210.HK","1269.HK","1966.HK","8363.HK","1848.HK","3799.HK","2199.HK","2349.HK","3683.HK","0309.HK","1235.HK","2389.HK","2339.HK","8101.HK","3303.HK","1194.HK","1036.HK","1863.HK","8237.HK","2988.HK","3816.HK","0299.HK","2010.HK","0381.HK","0215.HK","2362.HK","0722.HK","3939.HK","1699.HK","0633.HK","3398.HK","3633.HK","0542.HK","1086.HK","1069.HK","1399.HK","0471.HK","1386.HK","0484.HK","0558.HK","8246.HK","1383.HK","80737.HK","1177.HK","1271.HK","0953.HK","2033.HK","0842.HK","6118.HK","0931.HK","3339.HK","2688.HK","2030.HK","0841.HK","1228.HK","1698.HK","0362.HK","0496.HK","8238.HK","1107.HK","1991.HK","2699.HK","1172.HK","0872.HK","1011.HK","2669.HK","8007.HK","2098.HK","1822.HK","1362.HK","8311.HK","1241.HK","0580.HK","8123.HK","1626.HK","8220.HK","8111.HK","0587.HK","2222.HK","0455.HK","0067.HK","1310.HK","8098.HK","8122.HK","0930.HK","0573.HK","3301.HK","8070.HK","1689.HK","8063.HK","2768.HK","8025.HK","2907.HK","0374.HK","0569.HK","1102.HK","8099.HK","0228.HK","0095.HK","8315.HK","0591.HK","1495.HK","3836.HK","2298.HK","1728.HK","1428.HK","8331.HK","2005.HK","0556.HK","1566.HK","1217.HK","0926.HK","2133.HK","8179.HK","1129.HK","2083.HK","0695.HK","1148.HK","2314.HK","1389.HK","0973.HK","3087.HK","3017.HK","2844.HK","2816.HK","3092.HK","3020.HK","3015.HK","3016.HK","3055.HK","3082.HK","3061.HK","3063.HK","3045.HK","3062.HK","3099.HK","3105.HK","3005.HK","3025.HK","3052.HK","3049.HK","3013.HK","3065.HK","3106.HK","3026.HK","3011.HK","3007.HK","3057.HK","2848.HK","3036.HK","1206.HK","0778.HK","1151.HK","1085.HK","0967.HK","1021.HK","1866.HK","1048.HK","0770.HK","2178.HK","0844.HK","1619.HK","1738.HK","0370.HK","2689.HK","0361.HK","0326.HK","0650.HK","8398.HK","0439.HK","0735.HK","0111.HK","0555.HK","2905.HK","1176.HK","0608.HK","0094.HK","1811.HK","2000.HK","0383.HK","1068.HK","0876.HK","0259.HK","0988.HK","1135.HK","0115.HK","0458.HK","0680.HK","0539.HK","0802.HK","0369.HK","0313.HK","0559.HK","1100.HK","0124.HK","0692.HK","0099.HK","3678.HK","2345.HK","1202.HK","3993.HK","6826.HK","1000.HK","1353.HK","0670.HK","6866.HK","3833.HK","3948.HK","2009.HK","0187.HK","1527.HK","1330.HK","2039.HK","1680.HK","1136.HK","0265.HK","0801.HK","1673.HK","0456.HK","0637.HK","2700.HK","0831.HK","1532.HK","1636.HK","8121.HK","1155.HK","1480.HK","8088.HK","2913.HK","2268.HK","2183.HK","2789.HK","1190.HK","6133.HK","0629.HK","0422.HK","1862.HK","2320.HK","0815.HK","3608.HK","0464.HK","3822.HK","510010.SS","510680.SS","510420.SS","502000.SS","502001.SS","512210.SS","512230.SS","522971.SS","522975.SS","501002.SS","502016.SS","523985.SS","522985.SS","523971.SS","523975.SS","511880.SS","522665.SS","523664.SS","522664.SS","510430.SS","523665.SS","511930.SS","510581.SS","502032.SS","502031.SS","510880.SS","510170.SS","510560.SS","519002.SS","511980.SS","512500.SS","502018.SS","511010.SS","510660.SS","510650.SS","502017.SS","510630.SS","518800.SS","510610.SS","513100.SS","511210.SS","510050.SS","510410.SS","510020.SS","500058.SS","513500.SS","519889.SS","510330.SS","510620.SS","510090.SS","512990.SS","519888.SS","510230.SS","519801.SS","519800.SS","519119.SS","511900.SS","511960.SS","603919.SS","512010.SS","510510.SS","510520.SS","518880.SS","511860.SS","510710.SS","512600.SS","512220.SS","511220.SS","513600.SS","505888.SS","513660.SS","502002.SS","603066.SS","501000.SS","502010.SS","502058.SS","502053.SS","502005.SS","502008.SS","502042.SS","502011.SS","502022.SS","502020.SS","502012.SS","502054.SS","502056.SS","502021.SS","603520.SS","502057.SS","601155.SS","501001.SS","502007.SS","502041.SS","502003.SS","502023.SS","502055.SS","510580.SS","502024.SS","502040.SS","502025.SS","502026.SS","502028.SS","502004.SS","502027.SS","603027.SS","511820.SS","502006.SS","512510.SS","502038.SS","502036.SS","510360.SS","502037.SS","510290.SS","601988.SS","601398.SS","600640.SS","600635.SS","600027.SS","900932.SS","601998.SS","601808.SS","601006.SS","600809.SS","600618.SS","600519.SS","600426.SS","600180.SS","600104.SS","600079.SS","600036.SS","600029.SS","600015.SS","900930.SS","900922.SS","900918.SS","900915.SS","900907.SS","603838.SS","603729.SS","603398.SS","603366.SS","603318.SS","603268.SS","603188.SS","603168.SS","603108.SS","603003.SS","601996.SS","601939.SS","601818.SS","601801.SS","601799.SS","601788.SS","601766.SS","601717.SS","601677.SS","601628.SS","601618.SS","601600.SS","601588.SS","601558.SS","601555.SS","601258.SS","601169.SS","601166.SS","601118.SS","601111.SS","601100.SS","601098.SS","601088.SS","601028.SS","601018.SS","601012.SS","600999.SS","600993.SS","600990.SS","600988.SS","600983.SS","600967.SS","600965.SS","600959.SS","600893.SS","600892.SS","600890.SS","600889.SS","600875.SS","600858.SS","600857.SS","600841.SS","600826.SS","600825.SS","600824.SS","600822.SS","600819.SS","600812.SS","600805.SS","600797.SS","600792.SS","600790.SS","600789.SS","600770.SS","600765.SS","600756.SS","600750.SS","600744.SS","600742.SS","600741.SS","600738.SS","600737.SS","600736.SS","600719.SS","600706.SS","600703.SS","600695.SS","600694.SS","600684.SS","600681.SS","600680.SS","600677.SS","600671.SS","600662.SS","600649.SS","600641.SS","600633.SS","600629.SS","600626.SS","600605.SS","600600.SS","600592.SS","600588.SS","600583.SS","600572.SS","600570.SS","600549.SS","600545.SS","600535.SS","600521.SS","600503.SS","600498.SS","600462.SS","600452.SS","600444.SS","600438.SS","600422.SS","600418.SS","600415.SS","600400.SS","600395.SS","600377.SS","600358.SS","600356.SS","600351.SS","600350.SS","600345.SS","600337.SS","600335.SS","600320.SS","600309.SS","600308.SS","600305.SS","600302.SS","600295.SS","600292.SS","600291.SS","600283.SS","600282.SS","600271.SS","600267.SS","600255.SS","600247.SS","600241.SS","600240.SS","600233.SS","600216.SS","600213.SS","600207.SS","600197.SS","600196.SS","600190.SS","600177.SS","600172.SS","600171.SS","600168.SS","600167.SS","600166.SS","600152.SS","600148.SS","600136.SS","600135.SS","600132.SS","600131.SS","600127.SS","600123.SS","600111.SS","600088.SS","600086.SS","600066.SS","600056.SS","600055.SS","600054.SS","600053.SS","600038.SS","600031.SS","600021.SS","600020.SS","600018.SS","600017.SS","600016.SS","600011.SS","600010.SS","600008.SS","600456.SS","600105.SS","600491.SS","600608.SS","600145.SS","601700.SS","603788.SS","603555.SS","603311.SS","600191.SS","600317.SS","600887.SS","600069.SS","600536.SS","600532.SS","510190.SS","600978.SS","600775.SS","603696.SS","603300.SS","600710.SS","600262.SS","601616.SS","600393.SS","600303.SS","600718.SS","600962.SS","600776.SS","900935.SS","900934.SS","600281.SS","601899.SS","603019.SS","600696.SS","900940.SS","600060.SS","600185.SS","601311.SS","600319.SS","601001.SS","600328.SS","601633.SS","600509.SS","511890.SS","600516.SS","601789.SS","603166.SS","600520.SS","600232.SS","600760.SS","600539.SS","600091.SS","600149.SS","600581.SS","600361.SS","600883.SS","600785.SS","600163.SS","510310.SS","603799.SS","601000.SS","603993.SS","900924.SS","510260.SS","600513.SS","600873.SS","600073.SS","601519.SS","600222.SS","600975.SS","510070.SS","600795.SS","600259.SS","600439.SS","600886.SS","600468.SS","603000.SS","600421.SS","601991.SS","600657.SS","600575.SS","512340.SS","603778.SS","600239.SS","600475.SS","603611.SS","601918.SS","600781.SS","600331.SS","600745.SS","603088.SS","600771.SS","603077.SS","601179.SS","600811.SS","603023.SS","600506.SS","600231.SS","600157.SS","601208.SS","600109.SS","600888.SS","600576.SS","603589.SS","600052.SS","600850.SS","600463.SS","600330.SS","600782.SS","600981.SS","600604.SS","600654.SS","601800.SS","603399.SS","600150.SS","600837.SS","600122.SS","601798.SS","600348.SS","600485.SS","600774.SS","601069.SS","600815.SS","600287.SS","600836.SS","600481.SS","600602.SS","600405.SS","600764.SS","600100.SS","600843.SS","600712.SS","600969.SS","601669.SS","600894.SS","600298.SS","600290.SS","601901.SS","600512.SS","600862.SS","600594.SS","600005.SS","600329.SS","603698.SS","600556.SS","600369.SS","600193.SS","601225.SS","600355.SS","900912.SS","603806.SS","600814.SS","600367.SS","603002.SS","600299.SS","600787.SS","603866.SS","603118.SS","600229.SS","600026.SS","600676.SS","600313.SS","510210.SS","600000.SS","600648.SS","600141.SS","600372.SS","600540.SS","600218.SS","900939.SS","600169.SS","600566.SS","603686.SS","600332.SS","600423.SS","600279.SS","601339.SS","600155.SS","600634.SS","600392.SS","601007.SS","900906.SS","600360.SS","601288.SS","600769.SS","600386.SS","600023.SS","600189.SS","600987.SS","600076.SS","601515.SS","900936.SS","601636.SS","603989.SS","601218.SS","600449.SS","600371.SS","601016.SS","600261.SS","600867.SS","601890.SS","600336.SS","600061.SS","600095.SS","900947.SS","600083.SS","600757.SS","510450.SS","600114.SS","600628.SS","600107.SS","600467.SS","519011.SS","600984.SS","600856.SS","600170.SS","600508.SS","600478.SS","600525.SS","600715.SS","600869.SS","603026.SS","600614.SS","600729.SS","600288.SS","600307.SS","900933.SS","603223.SS","600265.SS","603338.SS","600823.SS","600217.SS","900937.SS","600072.SS","600067.SS","600783.SS","601898.SS","600368.SS","600383.SS","600096.SS","601038.SS","601003.SS","600817.SS","600085.SS","600479.SS","600187.SS","603688.SS","600636.SS","600997.SS","600206.SS","600526.SS","600704.SS","600973.SS","601186.SS","600399.SS","603969.SS","600674.SS","600917.SS","603703.SS","600697.SS","600702.SS","600470.SS","600138.SS","601226.SS","600518.SS","600493.SS","603997.SS","600063.SS","600685.SS","603616.SS","601965.SS","510030.SS","600103.SS","600112.SS","601929.SS","600835.SS","600252.SS","600584.SS","600724.SS","600420.SS","511990.SS","600080.SS","600133.SS","600740.SS","600064.SS","600496.SS","601107.SS","600833.SS","600486.SS","600713.SS","600108.SS","900938.SS","900901.SS","600620.SS","600179.SS","600050.SS","600601.SS","600613.SS","600058.SS","601872.SS","600980.SS","600807.SS","600791.SS","600363.SS","512110.SS","600234.SS","603936.SS","603009.SS","600653.SS","601106.SS","600068.SS","600380.SS","600256.SS","600767.SS","600796.SS","601928.SS","600728.SS","600459.SS","600780.SS","603128.SS","600831.SS","600698.SS","601388.SS","600396.SS","600558.SS","600359.SS","600711.SS","603306.SS","600280.SS","600226.SS","600223.SS","601009.SS","600257.SS","600650.SS","600571.SS","603606.SS","900956.SS","600249.SS","601158.SS","600059.SS","600803.SS","600480.SS","600156.SS","600603.SS","603608.SS","600884.SS","600768.SS","603618.SS","900905.SS","900914.SS","600118.SS","603818.SS","603996.SS","600810.SS","600158.SS","601699.SS","600425.SS","600779.SS","600182.SS","600501.SS","601211.SS","600435.SS","601058.SS","600895.SS","600688.SS","600982.SS","600579.SS","600868.SS","600870.SS","600515.SS","600569.SS","600186.SS","601010.SS","600161.SS","600235.SS","600089.SS","600408.SS","600647.SS","600137.SS","600203.SS","600866.SS","600221.SS","600098.SS","601233.SS","600074.SS","600730.SS","603766.SS","601368.SS","603315.SS","603669.SS","600855.SS","600375.SS","601689.SS","600714.SS","600865.SS","600178.SS","600617.SS","600699.SS","600285.SS","600854.SS","601168.SS","600961.SS","600844.SS","600587.SS","601880.SS","603167.SS","600727.SS","600821.SS","600845.SS","513030.SS","603309.SS","600859.SS","603299.SS","600746.SS","600139.SS","600793.SS","600009.SS","600165.SS","603636.SS","600106.SS","600489.SS","603123.SS","900903.SS","603158.SS","500056.SS","600759.SS","603979.SS","601099.SS","511810.SS","900952.SS","601222.SS","600326.SS","600820.SS","600555.SS","900909.SS","600755.SS","603169.SS","601377.SS","600543.SS","600502.SS","600215.SS","600033.SS","601390.SS","600387.SS","600487.SS","603328.SS","600366.SS","600458.SS","600538.SS","600316.SS","600201.SS","600872.SS","600362.SS","601002.SS","603222.SS","600802.SS","600258.SS","600176.SS","600352.SS","603601.SS","600547.SS","600838.SS","600839.SS","600339.SS","900908.SS","600721.SS","603789.SS","601599.SS","600272.SS","600490.SS","600693.SS","600373.SS","600642.SS","600834.SS","510900.SS","600028.SS","900927.SS","603020.SS","600708.SS","600656.SS","603828.SS","600398.SS","600097.SS","603085.SS","600461.SS","600117.SS","600557.SS","600099.SS","600093.SS","900957.SS","600119.SS","603021.SS","601919.SS","603355.SS","600624.SS","500038.SS","600726.SS","600300.SS","600243.SS","603999.SS","900948.SS","600808.SS","600658.SS","600661.SS","600876.SS","600497.SS","600970.SS","600476.SS","900943.SS","601518.SS","603126.SS","600126.SS","601318.SS","600891.SS","600208.SS","600198.SS","600665.SS","510180.SS","600219.SS","510120.SS","600897.SS","512330.SS","603227.SS","511800.SS","600683.SS","600998.SS","600228.SS","601888.SS","603699.SS","601985.SS","600585.SS","600315.SS","600666.SS","600115.SS","601231.SS","601313.SS","600577.SS","600237.SS","600596.SS","600871.SS","603005.SS","600037.SS","600754.SS","600312.SS","600758.SS","600778.SS","600090.SS","600153.SS","600804.SS","600527.SS","600829.SS","600250.SS","603598.SS","601989.SS","603117.SS","600523.SS","600269.SS","603566.SS","600725.SS","603567.SS","600612.SS","600353.SS","601008.SS","600448.SS","603100.SS","900945.SS","600578.SS","600346.SS","600121.SS","600630.SS","603889.SS","600739.SS","600110.SS","601566.SS","603006.SS","600690.SS","600323.SS","600220.SS","600622.SS","600652.SS","600284.SS","600406.SS","600589.SS","600537.SS","600378.SS","600370.SS","600860.SS","601999.SS","600976.SS","601668.SS","600610.SS","600184.SS","600212.SS","600550.SS","600275.SS","512120.SS","600209.SS","600322.SS","600563.SS","603012.SS","601908.SS","600668.SS","600565.SS","601101.SS","900921.SS","600645.SS","600686.SS","601727.SS","600293.SS","600428.SS","600403.SS","600900.SS","600160.SS","603939.SS","603116.SS","510500.SS","603898.SS","600500.SS","601113.SS","900928.SS","600195.SS","600070.SS","600877.SS","600507.SS","600505.SS","601969.SS","600230.SS","600268.SS","600716.SS","600113.SS","600846.SS","600340.SS","600733.SS","600236.SS","600551.SS","900923.SS","601126.SS","600183.SS","600531.SS","600717.SS","600419.SS","600619.SS","601877.SS","900913.SS","600673.SS","600801.SS","600338.SS","600847.SS","600992.SS","603377.SS","600687.SS","600675.SS","600120.SS","600663.SS","600477.SS","601015.SS","600853.SS","600590.SS","600747.SS","510130.SS","600573.SS","600321.SS","900925.SS","510160.SS","900917.SS","603008.SS","600580.SS","600818.SS","603883.SS","600735.SS","600567.SS","600794.SS","900955.SS","600199.SS","600548.SS","603901.SS","603099.SS","600682.SS","600246.SS","600488.SS","601369.SS","510060.SS","512640.SS","512070.SS","512610.SS","523972.SS","523976.SS","523973.SS","522973.SS","523977.SS","522972.SS","522976.SS","519973.SS","522977.SS","519972.SS","510440.SS","522677.SS","523677.SS","512511.SS","510280.SS","510110.SS","502015.SS","519300.SS","502013.SS","502050.SS","511830.SS","502014.SS","502049.SS","512310.SS","510150.SS","502048.SS","512300.SS","510220.SS","510300.SS","510270.SS","522566.SS","522567.SS","512221.SS","600410.SS","600297.SS","900953.SS","600568.SS","603558.SS","601333.SS","600966.SS","600731.SS","600460.SS","600310.SS","600071.SS","600116.SS","601199.SS","600482.SS","600995.SS","600751.SS","603018.SS","603568.SS","600707.SS","600734.SS","603600.SS","600318.SS","600401.SS","600958.SS","603025.SS","600062.SS","600159.SS","601718.SS","603368.SS","600311.SS","601567.SS","600082.SS","603011.SS","603010.SS","600057.SS","603918.SS","600078.SS","900926.SS","600101.SS","600896.SS","600388.SS","601336.SS","600455.SS","600864.SS","600597.SS","601139.SS","603609.SS","601866.SS","600466.SS","600679.SS","600763.SS","600851.SS","603718.SS","601021.SS","603519.SS","600130.SS","601857.SS","600260.SS","600720.SS","601678.SS","600986.SS","600637.SS","601216.SS","900902.SS","600798.SS","600379.SS","600643.SS","600397.SS","600882.SS","600692.SS","600593.SS","600691.SS","603808.SS","603017.SS","600985.SS","600863.SS","600651.SS","600129.SS","600528.SS","600325.SS","603456.SS","600469.SS","600777.SS","600599.SS","600753.SS","600830.SS","600606.SS","600012.SS","600749.SS","600960.SS","603199.SS","600094.SS","600748.SS","600151.SS","600861.SS","600227.SS","600615.SS","900910.SS","600562.SS","600251.SS","600598.SS","600879.SS","600816.SS","600007.SS","600623.SS","600827.SS","600382.SS","900950.SS","603308.SS","600365.SS","600238.SS","600616.SS","600343.SS","603998.SS","600242.SS","603800.SS","600880.SS","600723.SS","600077.SS","600499.SS","600173.SS","600530.SS","601579.SS","600128.SS","600266.SS","600289.SS","600761.SS","601968.SS","603508.SS","600391.SS","600655.SS","603001.SS","900946.SS","600609.SS","600638.SS","600390.SS","601116.SS","600644.SS","601608.SS","600611.SS","600881.SS","600678.SS","600971.SS","600162.SS","601137.SS","600146.SS","601900.SS","600175.SS","603899.SS","600660.SS","600389.SS","600200.SS","601601.SS","600766.SS","600433.SS","601005.SS","600722.SS","603968.SS","600192.SS","600806.SS","600446.SS","601886.SS","600006.SS","600561.SS","603599.SS","601328.SS","600019.SS","600664.SS","900904.SS","601992.SS","601688.SS","600125.SS","600595.SS","600075.SS","601607.SS","600143.SS","601011.SS","600248.SS","600560.SS","600689.SS","603333.SS","600848.SS","600202.SS","600277.SS","600225.SS","900929.SS","600004.SS","900919.SS","600327.SS","900951.SS","601117.SS","603678.SS","601777.SS","600510.SS","603885.SS","600276.SS","600979.SS","600621.SS","600582.SS","600432.SS","600436.SS","600273.SS"]


# Function to fetch data for a given stock
def fetch_stock_data(stock):
    try:
        data = yf.Ticker(stock)
        info = data.info
        name = info.get('shortName', 'N/A')
        previous_close = format_currency(info.get('previousClose', 'N/A'))
        market_cap = format_currency(info.get('marketCap', 'N/A'))
        open_price = format_currency(info.get('regularMarketOpen', 'N/A'))
        average_price = format_currency(info.get('regularMarketPrice', 'N/A'))
        beta = info.get('beta', 'N/A')
        bid_price = format_currency(info.get('bid', 'N/A'))
        ask_price = format_currency(info.get('ask', 'N/A'))
        pe_ratio_ttm = info.get('trailingPE', 'N/A')
        eps_ttm = format_currency(info.get('trailingEps', 'N/A'))
        day_range = format_currency(info.get('dayLow', 'N/A')) + ' - ' + format_currency(info.get('dayHigh', 'N/A'))
        fifty_two_week_range = format_currency(info.get('fiftyTwoWeekLow', 'N/A')) + ' - ' + format_currency(info.get('fiftyTwoWeekHigh', 'N/A'))
        one_year_target = format_currency(info.get('targetMeanPrice', 'N/A'))
        fifty_two_week_change = format_percentage(info.get('52WeekChange', 'N/A'))
        earnings_date = info.get('earningsDate', 'N/A')
        forward_dividend = format_currency(info.get('forwardDividendRate', 'N/A'))
        dividend_yield = format_percentage(info.get('dividendYield', 'N/A'))
        volume = info.get('volume', 'N/A')
        ex_dividend_date = info.get('exDividendDate', 'N/A')
        enterprise_value = format_currency(info.get('enterpriseValue', 'N/A'))
        pe_ratio_trailing = info.get('trailingPE', 'N/A')
        pe_ratio_forward = info.get('forwardPE', 'N/A')
        peg_ratio = info.get('pegRatio', 'N/A')
        price_sales_ratio = info.get('priceToSalesTrailing12Months', 'N/A')
        price_book_ratio = info.get('priceToBook', 'N/A')
        fifty_day_moving_average = format_currency(info.get('fiftyDayAverage', 'N/A'))
        two_hundred_day_moving_average = format_currency(info.get('twoHundredDayAverage', 'N/A'))
        enterprise_value_ebitda = format_currency(info.get('enterpriseToEbitda', 'N/A'))
        profit_margin = format_percentage(info.get('profitMargins', 'N/A'))
        operating_margin = format_percentage(info.get('operatingMargins', 'N/A'))
        return_on_assets = format_percentage(info.get('returnOnAssets', 'N/A'))
        return_on_equity = format_percentage(info.get('returnOnEquity', 'N/A'))
        revenue = format_currency(info.get('totalRevenue', 'N/A'))
        revenue_per_share = format_currency(info.get('revenuePerShare', 'N/A'))
        quarterly_revenue_growth = format_percentage(info.get('quarterlyRevenueGrowth', 'N/A'))
        gross_profit = format_currency(info.get('grossProfit', 'N/A'))
        ebitda = format_currency(info.get('ebitda', 'N/A'))
        diluted_eps = format_currency(info.get('trailingEps', 'N/A'))
        quarterly_earnings_growth = format_percentage(info.get('earningsQuarterlyGrowth', 'N/A'))
        total_cash = format_currency(info.get('totalCash', 'N/A'))
        total_cash_per_share = format_currency(info.get('totalCashPerShare', 'N/A'))
        total_debt = format_currency(info.get('totalDebt', 'N/A'))
        current_ratio = info.get('currentRatio', 'N/A')
        book_value_per_share = format_currency(info.get('bookValue', 'N/A'))
        operating_cash_flow = format_currency(info.get('operatingCashflow', 'N/A'))
        levered_free_cash_flow = format_currency(info.get('freeCashflow', 'N/A'))
        share_statistics = format_currency(info.get('sharesOutstanding', 'N/A'))
        dividends_splits = info.get('dividendsAndSplits', 'N/A')
        about_company = info.get('longBusinessSummary', 'N/A')

        return {
            "Symbol": stock,
            "Name": name,
            "Previous Close": previous_close,
            "Market Cap": market_cap,
            "Open Price": open_price,
            "Average Price": average_price,
            "Beta (1 year)": beta,
            "Bid Price": bid_price,
            "Ask Price": ask_price,
            "PE Ratio (TTM)": pe_ratio_ttm,
            "EPS (TTM)": eps_ttm,
            "Day's Range": day_range,
            "52 Week Range": fifty_two_week_range,
            "1 Year Target": one_year_target,
            "52 Week Change (%)": fifty_two_week_change,
            "Earnings Date": earnings_date,
            "Forward Dividend": forward_dividend,
            "Dividend Yield": dividend_yield,
            "Volume": volume,
            "Ex-Dividend Date": ex_dividend_date,
            "Enterprise Value": enterprise_value,
            "Price/Earnings Ratio (Trailing)": pe_ratio_trailing,
            "Price/Earnings Ratio (Forward)": pe_ratio_forward,
            "PEG Ratio": peg_ratio,
            "Price/Sales Ratio": price_sales_ratio,
            "Price/Book Ratio": price_book_ratio,
            "50-Day Moving Average": fifty_day_moving_average,
            "200-Day Moving Average": two_hundred_day_moving_average,
            "Enterprise Value/EBITDA": enterprise_value_ebitda,
            "Profit Margin": profit_margin,
            "Operating Margin": operating_margin,
            "Return on Assets": return_on_assets,
            "Return on Equity": return_on_equity,
            "Revenue": revenue,
            "Revenue per Share": revenue_per_share,
            "Quarterly Revenue Growth": quarterly_revenue_growth,
            "Gross Profit": gross_profit,
            "EBITDA": ebitda,
            "Diluted EPS": diluted_eps,
            "Quarterly Earnings Growth": quarterly_earnings_growth,
            "Total Cash (MRQ)": total_cash,
            "Total Cash Per Share (MRQ)": total_cash_per_share,
            "Total Debt (MRQ)": total_debt,
            "Current Ratio (MRQ)": current_ratio,
            "Book Value Per Share (MRQ)": book_value_per_share,
            "Operating Cash Flow (TTM)": operating_cash_flow,
            "Levered Free Cash Flow (TTM)": levered_free_cash_flow,
            "Share Statistics": share_statistics,
            "Dividends & Splits": dividends_splits,
            "About Company": about_company
        }
    except Exception as e:
        print(f"Error fetching data for {stock}: {e}")
        return None

# Function to update data for selected stocks
def update_selected_stocks_data(selected_stocks, progress_bar):
    data = []
    for i, stock in enumerate(selected_stocks):
        progress_bar.progress((i + 1) / len(selected_stocks))
        stock_data = fetch_stock_data(stock)
        if stock_data:
            data.append(stock_data)
    return data

# Function to format currency
def format_currency(value):
    if value != 'N/A':
        return "${:,.2f}".format(value)
    else:
        return value

# Function to format percentage
def format_percentage(value):
    if value != 'N/A':
        return "{:.2f}%".format(value)
    else:
        return value

# Main function to run the Streamlit app
def main():
    st.title("Stock Data Dashboard")

    # Sidebar for selecting stocks
    all_stocks_option = st.sidebar.checkbox("Select All Stocks")
    if all_stocks_option:
        selected_stocks = stocks
    else:
        selected_stocks = st.sidebar.multiselect("Select Stocks", stocks)

    # Placeholder to show data
    placeholder = st.empty()

    # Progress bar
    progress_bar = st.progress(0)

    # Main loop for real-time updates
    while True:
        if selected_stocks:
            stocks_data = update_selected_stocks_data(selected_stocks, progress_bar)
        else:
            stocks_data = update_selected_stocks_data(stocks, progress_bar)

        if not stocks_data:
            placeholder.write("No data to display.")
        else:
            df = pd.DataFrame(stocks_data)
            placeholder.dataframe(df)

        time.sleep(60)  # Wait for 60 seconds before next update

        # Download the metrics table as xlsx
# Download the metrics table as xlsx


if __name__ == "__main__":
    main()

